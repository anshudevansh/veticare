<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Animal Disease Predictor</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" crossorigin="anonymous">

  <style>
    body {
      background: linear-gradient(135deg, #e0f7fa, #fff3e0);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
      padding: 30px;
      width: 100%;
      max-width: 700px;
      animation: fadeIn 1s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    .btn-add {
      background-color: #17a2b8;
      border: none;
      color: white;
    }
    .btn-add:hover {
      background-color: #138496;
    }
    .btn-submit {
      background-color: #28a745;
      border: none;
      color: white;
    }
    .btn-submit:hover {
      background-color: #218838;
    }
    .symptom-group {
      margin-bottom: 15px;
    }
  </style>
</head>

<body>

<div class="glass-card">

  <h2 class="text-center font-weight-bold mb-4">Animal Disease Predictor</h2>

  <form action="/predict" method="POST" id="predictionForm">

    <!-- Animal Name Dropdown -->
    <div class="form-group">
      <label for="AnimalName" class="font-weight-bold">Select Animal</label>
      <select class="form-control" id="AnimalName" name="AnimalName" required>
        {% for name in AnimalName %}
          <option value="{{ name }}">{{ name }}</option>
        {% endfor %}
      </select>
    </div>

    <!-- Symptoms Section -->
    <div id="symptomsContainer">
      <div class="form-group symptom-group">
        <label for="symptom0" class="font-weight-bold">Symptom 1</label>
        <select class="form-control" name="symptoms[]" id="symptom0" required>
          {% for symptom in symptoms %}
            <option value="{{ symptom }}">{{ symptom }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="text-right">
      <button type="button" id="addSymptomBtn" class="btn btn-add mb-3">+ Add Symptom</button>
    </div>

    <!-- Submit Button -->
    <div class="text-center">
      <button type="submit" class="btn btn-submit btn-lg px-5" id="submitBtn">
        <span id="spinner" class="spinner-border spinner-border-sm d-none mr-2" role="status" aria-hidden="true"></span>
        Predict
      </button>
    </div>

  </form>

  <!-- Prediction Output -->
  {% if prediction_text %}
  <div class="text-center mt-4">
    <div class="alert alert-success" role="alert">
      <h4 class="alert-heading">{{ prediction_text }}</h4>
    </div>
  </div>
  {% endif %}

</div>

<!-- JavaScript -->
<script>
  // âœ… Pass the Python symptoms list to JavaScript
  const symptomsList = {{ symptoms | tojson }};

  let symptomCount = 1;

  document.getElementById('addSymptomBtn').addEventListener('click', function() {
    if (symptomCount >= 5) {
      alert('You can only add up to 5 symptoms.');
      return;
    }

    const container = document.getElementById('symptomsContainer');

    const newDiv = document.createElement('div');
    newDiv.className = 'form-group symptom-group';

    const label = document.createElement('label');
    label.setAttribute('for', `symptom${symptomCount}`);
    label.className = 'font-weight-bold';
    label.innerText = `Symptom ${symptomCount + 1}`;

    const select = document.createElement('select');
    select.className = 'form-control';
    select.name = 'symptoms[]';
    select.id = `symptom${symptomCount}`;
    select.required = true;

    symptomsList.forEach(symptom => {
      const option = document.createElement('option');
      option.value = symptom;
      option.text = symptom;
      select.appendChild(option);
    });

    newDiv.appendChild(label);
    newDiv.appendChild(select);
    container.appendChild(newDiv);

    symptomCount++;
  });

  // Spinner Activation
  document.getElementById('predictionForm').addEventListener('submit', function() {
    const spinner = document.getElementById('spinner');
    const submitBtn = document.getElementById('submitBtn');
    spinner.classList.remove('d-none');
    submitBtn.setAttribute('disabled', true);
    submitBtn.classList.add('disabled');
  });
</script>

<!-- Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" crossorigin="anonymous"></script>

</body>
</html>
